<?xml version="1.0" encoding="UTF-8"?>
<svg class="gsndiagram" viewBox="0 0 922 1010" xmlns="http://www.w3.org/2000/svg">
<defs>
<marker id="supportedby_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill="black" points="0 0, 10 4.5, 0 9"/>
</marker>
<marker id="incontextof_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill-opacity="0" points="0 0, 10 4.5, 0 9, 0 0" stroke="black" stroke-width="1"/>
</marker>
<symbol id="module_icon">
<rect fill="lightgrey" height="5" stroke="black" stroke-width="1" width="10" x="0" y="0"/>
<rect fill="lightgrey" height="10" stroke="black" stroke-width="1" width="20" x="0" y="5"/>
</symbol>
</defs>
<style type="text/css">
svg { background-color: white;}

/* CSS to invert SVG for dark mode */ 
@media (prefers-color-scheme: dark) {
    svg { filter: invert(100%); background-color: black; }
}

</style>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_solecontrol">
<title>G_SoleControl</title>
<path class="border" d="M496,35 L646,35 L646,105 L496,105 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="503" y="55">G_SoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="503" y="73">PID issuer has assurance</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="503" y="86">that User will have sole</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="503" y="99">control over the PID</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnasmp" id="node_a_pidissuertrustswb">
<title>A_PidIssuerTrustsWb</title>
<path class="border" d="M686,70 a108,50,0,1,0,217,0 a108,50,0,1,0,-217,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="724" y="49">A_PidIssuerTrustsWb</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="724" y="67">PID issuer trusts WB to</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="724" y="80">issue WUA only to wallets</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="724" y="93">implementing Sole Control</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="897" y="115">A</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_wbenforcessolecontrol">
<title>G_WbEnforcesSoleControl</title>
<path class="border" d="M389,160 L555,160 L555,244 L389,244 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="396" y="180">G_WbEnforcesSoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="396" y="198">WB enforces that the User</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="396" y="211">has sole control over all</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="396" y="224">attestations managed in</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="396" y="237">Wallet</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal gsn_undeveloped" id="node_g_wbissueswua">
<title>G_WbIssuesWua</title>
<path class="border" d="M595,177 L747,177 L747,227 L595,227 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="602" y="197">G_WbIssuesWua</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="602" y="215">WB issues WUA to Wallet</text>
<path d="M671,227 l5,5 l-5,5 l-5,-5 z" fill-opacity="0" stroke="black" stroke-width="1"/>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnctxt" id="node_c_attestationdefinition">
<title>C_AttestationDefinition</title>
<path class="border" d="M78,301 L224,301 C234,301,234,371,224,371 L78,371 C68,371,68,301,78,301" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="85" y="321">C_AttestationDefinition</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="85" y="339">Attestation consists of</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="85" y="352">PrivKey and Attestation</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="85" y="365">Data</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_privkeyexclusivecustody">
<title>G_PrivKeyExclusiveCustody</title>
<path class="border" d="M274,301 L450,301 L450,371 L274,371 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="281" y="321">G_PrivKeyExclusiveCustody</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="281" y="339">PrivKey remains under</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="281" y="352">exclusive custody of WB</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="281" y="365">and is never exposed</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnasmp" id="node_a_wbistrusted">
<title>A_WbIsTrusted</title>
<path class="border" d="M490,336 a102,50,0,1,0,205,0 a102,50,0,1,0,-205,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="526" y="315">A_WbIsTrusted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="526" y="333">WB is trusted by Issuers,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="526" y="346">Verifiers, Wallets to not</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="526" y="359">obtain Attestation Data</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="689" y="381">A</text>
</g>
<a href="sole-control-2fa.gsn.svg#node_g_privkeyrequires2fa">
<g class="gsn_module_sole_control_2fa gsnelem gsnawaygoal" id="node_g_privkeyrequires2fa">
<title>G_PrivKeyRequires2fa</title>
<path class="border" d="M734,361 V284 H898 V361" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="741" y="304">G_PrivKeyRequires2fa</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="741" y="322">WB allows usage of PrivKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="741" y="335">only after 2FA</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="741" y="348">authentication of User</text>
<a href="sole-control-2fa.gsn.svg#node_g_privkeyrequires2fa">
<path class="border" d="M734,361 H898 v27 H734 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="768" y="381">sole_control_2fa</text>
</a>
<use href="#module_icon" x="741" y="368"/>
</g>
</a>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_walletstoresattestationdata">
<title>Sn_WalletStoresAttestationData</title>
<path class="border" d="M20,537 a109,109,0,1,0,218,0 a109,109,0,1,0,-218,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="38" y="516">Sn_WalletStoresAttestationData</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="38" y="534">Wallet stores and maintains</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="38" y="547">Attestation Data but not</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="38" y="560">PrivKey</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnstgy" id="node_s_ensureprivkeysecure">
<title>S_EnsurePrivKeySecure</title>
<path class="border" d="M285,502 L453,502 L439,572 L271,572 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="292" y="522">S_EnsurePrivKeySecure</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="290" y="540">Ensure secure generation,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="288" y="553">storage, and usage of</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="286" y="566">PrivKey</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnasmp" id="node_a_wbtrustshsmvendor">
<title>A_WbTrustsHsmVendor</title>
<path class="border" d="M486,537 a112,41,0,1,0,224,0 a112,41,0,1,0,-224,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="526" y="522">A_WbTrustsHsmVendor</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="526" y="540">WB trusts HSM vendor and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="526" y="553">certification</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="705" y="573">A</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_privkeycannotbeextracted">
<title>G_PrivKeyCannotBeExtracted</title>
<path class="border" d="M24,692 L208,692 L208,750 L24,750 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="31" y="712">G_PrivKeyCannotBeExtracted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="31" y="730">PrivKey cannot be extracted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="31" y="743">or copied from HSM</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_privkeyinhsm">
<title>G_PrivKeyInHsm</title>
<path class="border" d="M283,686 L413,686 L413,756 L283,756 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="290" y="706">G_PrivKeyInHsm</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="290" y="724">PrivKey is generated</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="290" y="737">inside a certified HSM</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="290" y="750">controlled by WB</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_hsmenforcesnonexport">
<title>Sn_HsmEnforcesNonExport</title>
<path class="border" d="M20,892 a96,96,0,1,0,192,0 a96,96,0,1,0,-192,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="36" y="877">Sn_HsmEnforcesNonExport</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="36" y="895">HSM enforces non-export</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="36" y="908">policy for PrivKey</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_wbuseshsmforprivkey">
<title>Sn_WbUsesHsmForPrivKey</title>
<path class="border" d="M252,892 a96,96,0,1,0,192,0 a96,96,0,1,0,-192,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="269" y="877">Sn_WbUsesHsmForPrivKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="269" y="895">WB uses certified HSM to</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="269" y="908">generate &amp; protect PrivKey</text>
</g>
<path class="gsnedge gsninspby" d="M116,750 C116,780,116,766,116,786" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M450,336 C480,336,460,336,480,336" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M274,336 C244,336,264,336,244,336" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M362,371 C362,401,362,472,362,492" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M348,756 C348,786,348,766,348,786" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M646,70 C676,70,656,70,676,70" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M571,105 C571,135,472,130,472,150" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M571,105 C571,135,671,147,671,167" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M472,244 C472,274,362,271,362,291" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M472,244 C472,274,816,254,816,274" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M472,244 C472,274,254,241,254,336 S129,398,129,418" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M446,537 C476,537,456,537,476,537" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M362,572 C362,602,116,662,116,682" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M362,572 C362,602,348,656,348,676" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
</svg>