<?xml version="1.0" encoding="UTF-8"?>
<svg class="gsndiagram" viewBox="0 0 1684 1139" xmlns="http://www.w3.org/2000/svg">
<defs>
<marker id="supportedby_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill="black" points="0 0, 10 4.5, 0 9"/>
</marker>
<marker id="incontextof_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill-opacity="0" points="0 0, 10 4.5, 0 9, 0 0" stroke="black" stroke-width="1"/>
</marker>
<symbol id="module_icon">
<rect fill="lightgrey" height="5" stroke="black" stroke-width="1" width="10" x="0" y="0"/>
<rect fill="lightgrey" height="10" stroke="black" stroke-width="1" width="20" x="0" y="5"/>
</symbol>
</defs>
<style type="text/css">
svg { background-color: white;}

/* CSS to invert SVG for dark mode */ 
@media (prefers-color-scheme: dark) {
    svg { filter: invert(100%); background-color: black; }
}

</style>
<a href="rp_session.svg#node_g_trustpidissuer">
<g class="gsn_module_rp_session_attribute gsnelem gsnawaygoal" id="node_g_trustpidissuer">
<title>G_TrustPidIssuer</title>
<path class="border" d="M872,149 V20 H1044 V149" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="879" y="40">G_TrustPidIssuer</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="58">RP trusts the PID issuer to (1)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="71">issue only to wallets that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="84">implement Sole Control, (2)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="97">issue only attributes that it</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="110">has checked to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="123">correct, (3) issue the PID at</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="879" y="136">LoA High</text>
<a href="rp_session.svg#node_g_trustpidissuer">
<path class="border" d="M872,149 H1044 v27 H872 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="906" y="169">rp_session_attribute</text>
</a>
<use href="#module_icon" x="879" y="156"/>
</g>
</a>
<a href="PID_issuer.gsn.svg#node_s_assurancewalletsolecontrol">
<g class="gsn_module_pid_issuer gsnelem gsnstgy" id="node_s_assurancewalletsolecontrol">
<title>S_AssuranceWalletSoleControl</title>
<path class="border" d="M1091,63 L1299,63 L1285,133 L1077,133 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1099" y="83">S_AssuranceWalletSoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1097" y="101">PID issuer enforces that the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1095" y="114">PID is issued to a wallet</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1093" y="127">implementing Sole Control</text>
</g>
</a>
<g class="gsn_module_sole_control_main gsnelem gsnasmp" id="node_a_pidissuertrustswb">
<title>A_PidIssuerTrustsWb</title>
<path class="border" d="M1332,98 a119,50,0,1,0,238,0 a119,50,0,1,0,-238,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1374" y="77">A_PidIssuerTrustsWb</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1374" y="95">PID issuer trusts WB to issue</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1374" y="108">WUA only to wallets</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1374" y="121">implementing Sole Control</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1565" y="143">A</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_solecontrol">
<title>G_SoleControl</title>
<path class="border" d="M866,216 L1050,216 L1050,286 L866,286 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="873" y="236">G_SoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="873" y="254">WB offers PID issuer assurance</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="873" y="267">that User will have sole</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="873" y="280">control over the PID</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_wbenforcessolecontrol">
<title>G_WbEnforcesSoleControl</title>
<path class="border" d="M385,326 L563,326 L563,396 L385,396 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="392" y="346">G_WbEnforcesSoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="392" y="364">WB enforces that the User has</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="392" y="377">sole control over all</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="392" y="390">attestations managed in Wallet</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_wbissueswua">
<title>G_WbIssuesWua</title>
<path class="border" d="M1366,339 L1518,339 L1518,383 L1366,383 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1373" y="359">G_WbIssuesWua</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1373" y="377">WB issues WUA to Wallet</text>
</g>
<a href="sole-control-2fa.gsn.svg#node_g_privkeyrequires2fa">
<g class="gsn_module_sole_control_2fa gsnelem gsnawaygoal" id="node_g_privkeyrequires2fa">
<title>G_PrivKeyRequires2fa</title>
<path class="border" d="M20,570 V493 H208 V570" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="27" y="513">G_PrivKeyRequires2fa</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="531">WB allows usage of PrivKey only</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="544">after 2FA authentication of</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="557">User</text>
<a href="sole-control-2fa.gsn.svg#node_g_privkeyrequires2fa">
<path class="border" d="M20,570 H208 v27 H20 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="54" y="590">sole_control_2fa</text>
</a>
<use href="#module_icon" x="27" y="577"/>
</g>
</a>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_walletstoresattestationdata">
<title>Sn_WalletStoresAttestationData</title>
<path class="border" d="M248,545 a109,109,0,1,0,218,0 a109,109,0,1,0,-218,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="266" y="524">Sn_WalletStoresAttestationData</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="266" y="542">Wallet stores and maintains</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="266" y="555">Attestation Data but not</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="266" y="568">PrivKey</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnctxt" id="node_c_attestationdefinition">
<title>C_AttestationDefinition</title>
<path class="border" d="M516,516 L690,516 C700,516,700,574,690,574 L516,574 C506,574,506,516,516,516" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="523" y="536">C_AttestationDefinition</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="523" y="554">Attestation consists of PrivKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="523" y="567">and Attestation Data</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_privkeyexclusivecustody">
<title>G_PrivKeyExclusiveCustody</title>
<path class="border" d="M740,510 L928,510 L928,580 L740,580 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="747" y="530">G_PrivKeyExclusiveCustody</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="747" y="548">PrivKey remains under exclusive</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="747" y="561">custody of WB and is never</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="747" y="574">exposed</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnasmp" id="node_a_wbistrusted">
<title>A_WbIsTrusted</title>
<path class="border" d="M968,545 a102,50,0,1,0,205,0 a102,50,0,1,0,-205,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1004" y="524">A_WbIsTrusted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1004" y="542">WB is trusted by Issuers,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1004" y="555">Verifiers, Wallets to not</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1004" y="568">obtain Attestation Data</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1167" y="590">A</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_wbgeneratesattestationprivkey">
<title>G_WbGeneratesAttestationPrivKey</title>
<path class="border" d="M1212,516 L1426,516 L1426,574 L1212,574 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1219" y="536">G_WbGeneratesAttestationPrivKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1219" y="554">WB generates a fresh WUA private</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1219" y="567">key</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_wbissueswua">
<title>Sn_WbIssuesWua</title>
<path class="border" d="M1466,545 a99,99,0,1,0,198,0 a99,99,0,1,0,-198,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1487" y="517">Sn_WbIssuesWua</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1487" y="535">WB constructs &amp; signs WUA</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1487" y="548">containing the corresponding</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1487" y="561">public key and issues it to the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1487" y="574">wallet</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnstgy" id="node_s_ensureprivkeysecure">
<title>S_EnsurePrivKeySecure</title>
<path class="border" d="M152,706 L340,706 L326,764 L138,764 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="159" y="726">S_EnsurePrivKeySecure</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="156" y="744">Ensure secure generation,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="153" y="757">storage, and usage of PrivKey</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnasmp" id="node_a_wbtrustshsmvendor">
<title>A_WbTrustsHsmVendor</title>
<path class="border" d="M373,735 a112,41,0,1,0,224,0 a112,41,0,1,0,-224,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="413" y="720">A_WbTrustsHsmVendor</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="413" y="738">WB trusts HSM vendor and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="413" y="751">certification</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="592" y="771">A</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_privkeycannotbeextracted">
<title>G_PrivKeyCannotBeExtracted</title>
<path class="border" d="M29,816 L213,816 L213,874 L29,874 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="36" y="836">G_PrivKeyCannotBeExtracted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="36" y="854">PrivKey cannot be extracted or</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="36" y="867">copied from HSM</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsngoal" id="node_g_privkeyinhsm">
<title>G_PrivKeyInHsm</title>
<path class="border" d="M268,816 L448,816 L448,874 L268,874 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="275" y="836">G_PrivKeyInHsm</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="275" y="854">PrivKey is generated inside a</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="275" y="867">certified HSM controlled by WB</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_hsmenforcesnonexport">
<title>Sn_HsmEnforcesNonExport</title>
<path class="border" d="M20,1015 a101,101,0,1,0,202,0 a101,101,0,1,0,-202,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="36" y="1000">Sn_HsmEnforcesNonExport</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="36" y="1018">HSM enforces non-export policy</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="36" y="1031">for PrivKey</text>
</g>
<g class="gsn_module_sole_control_main gsnelem gsnsltn" id="node_sn_wbuseshsmforprivkey">
<title>Sn_WbUsesHsmForPrivKey</title>
<path class="border" d="M262,1015 a96,96,0,1,0,192,0 a96,96,0,1,0,-192,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="279" y="1000">Sn_WbUsesHsmForPrivKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="279" y="1018">WB uses certified HSM to</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="279" y="1031">generate &amp; protect PrivKey</text>
</g>
<path class="gsnedge gsninspby" d="M121,874 C121,904,121,884,121,904" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M928,545 C958,545,938,545,958,545" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M740,545 C710,545,730,545,710,545" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M834,580 C834,610,239,676,239,696" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M358,874 C358,904,358,889,358,909" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M958,216 C958,186,1451,178,1451,158" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M958,286 C958,316,474,296,474,316" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M958,286 C958,316,1442,309,1442,329" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M958,176 C958,206,958,186,958,206" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M474,396 C474,426,834,480,834,500" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M474,396 C474,426,114,463,114,483" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M474,396 C474,426,357,406,357,426" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1319,574 C1319,604,239,676,239,696" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1442,383 C1442,413,1319,486,1319,506" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1442,383 C1442,413,1565,416,1565,436" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M1292,98 C1322,98,1302,98,1322,98" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M333,735 C363,735,343,735,363,735" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M239,764 C239,794,121,786,121,806" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M239,764 C239,794,358,786,358,806" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
</svg>