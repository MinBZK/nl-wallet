<?xml version="1.0" encoding="UTF-8"?>
<svg class="gsndiagram" viewBox="0 0 2166 926" xmlns="http://www.w3.org/2000/svg">
<defs>
<marker id="supportedby_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill="black" points="0 0, 10 4.5, 0 9"/>
</marker>
<marker id="incontextof_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill-opacity="0" points="0 0, 10 4.5, 0 9, 0 0" stroke="black" stroke-width="1"/>
</marker>
<symbol id="module_icon">
<rect fill="lightgrey" height="5" stroke="black" stroke-width="1" width="10" x="0" y="0"/>
<rect fill="lightgrey" height="10" stroke="black" stroke-width="1" width="20" x="0" y="5"/>
</symbol>
</defs>
<style type="text/css">
svg { background-color: white;}

/* CSS to invert SVG for dark mode */ 
@media (prefers-color-scheme: dark) {
    svg { filter: invert(100%); background-color: black; }
}

</style>
<a href="rp_session.svg#node_g_trustpidissuer">
<g class="gsn_module_rp_session_attribute gsnelem gsnawaygoal" id="node_g_trustpidissuer">
<title>G_TrustPidIssuer</title>
<path class="border" d="M820,149 V20 H992 V149" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="827" y="40">G_TrustPidIssuer</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="58">RP trusts the PID issuer to (1)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="71">issue only to wallets that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="84">implement Sole Control, (2)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="97">issue only attributes that it</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="110">has checked to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="123">correct, (3) issue the PID at</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="136">LoA High</text>
<a href="rp_session.svg#node_g_trustpidissuer">
<path class="border" d="M820,149 H992 v27 H820 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="854" y="169">rp_session_attribute</text>
</a>
<use href="#module_icon" x="827" y="156"/>
</g>
</a>
<g class="gsn_module_pid_issuer gsnelem gsngoal" id="node_g_issuepidatloahigh">
<title>G_IssuePidAtLoAHigh</title>
<path class="border" d="M820,216 L992,216 L992,300 L820,300 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="827" y="236">G_IssuePidAtLoAHigh</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="254">PID issuer issues at LoA High</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="267">and issues only attributes that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="280">it knows to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="827" y="293">correct</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnstgy" id="node_s_idpauthenticationatloahigh">
<title>S_IdpAuthenticationAtLoAHigh</title>
<path class="border" d="M27,351 L219,351 L205,413 L13,413 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="27" y="371">S_IdpAuthenticationAtLoAHigh</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="389">PID issuer identifies and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="402">authenticates at LoA high</text>
<path d="M116,413 l5,5 l-5,5 l-5,-5 z" fill-opacity="0" stroke="black" stroke-width="1"/>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnctxt" id="node_c_idpauthatloahighexpl">
<title>C_IdpAuthAtLoAHighExpl</title>
<path class="border" d="M262,360 L448,360 C458,360,458,404,448,404 L262,404 C252,404,252,360,262,360" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="269" y="380">C_IdpAuthAtLoAHighExpl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="269" y="398">Method not in scope of this GSN</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnstgy" id="node_s_assureattributecorrectness">
<title>S_AssureAttributeCorrectness</title>
<path class="border" d="M550,353 L754,353 L740,411 L536,411 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="558" y="373">S_AssureAttributeCorrectness</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="555" y="391">Assure factual correctness of</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="552" y="404">all issued attributes</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnstgy" id="node_s_assureissuancetocorrectwallet">
<title>S_AssureIssuanceToCorrectWallet</title>
<path class="border" d="M1590,340 L1818,340 L1804,424 L1576,424 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1598" y="360">S_AssureIssuanceToCorrectWallet</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1596" y="378">Assure that the PID is issued to</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1594" y="391">the same wallet instance that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1592" y="404">authenticated and proved</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1590" y="417">association with the user</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsngoal" id="node_g_determineattributesfromauthoritativesources">
<title>G_DetermineAttributesFromAuthoritativeSources</title>
<path class="border" d="M20,494 L316,494 L316,552 L20,552 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="27" y="514">G_DetermineAttributesFromAuthoritativeSources</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="532">PID issuer determines attribute values using</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="545">authoritative and governed sources</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnasmp" id="node_a_authoritativeregistersaregoverned">
<title>A_AuthoritativeRegistersAreGoverned</title>
<path class="border" d="M356,523 a163,59,0,1,0,327,0 a163,59,0,1,0,-327,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="410" y="495">A_AuthoritativeRegistersAreGoverned</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="410" y="513">Authoritative source registers are</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="410" y="526">governed, accurate, and audited</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="410" y="539">within the applicable trust</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="410" y="552">framework</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="677" y="577">A</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsngoal" id="node_g_bindattributestoauthenticatedsubject">
<title>G_BindAttributesToAuthenticatedSubject</title>
<path class="border" d="M722,488 L972,488 L972,558 L722,558 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="729" y="508">G_BindAttributesToAuthenticatedSubject</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="729" y="526">PID issuer makes sure that the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="729" y="539">attributes belong to the authenticated</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="729" y="552">subject before issuance</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsngoal" id="node_g_maintainattributelifecyclevalidity">
<title>G_MaintainAttributeLifecycleValidity</title>
<path class="border" d="M1012,501 L1234,501 L1234,545 L1012,545 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1019" y="521">G_MaintainAttributeLifecycleValidity</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1019" y="539">PID issuer ensures attribute validity</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsngoal" id="node_g_provewalletassociation">
<title>G_ProveWalletAssociation</title>
<path class="border" d="M1304,475 L1496,475 L1496,571 L1304,571 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1311" y="495">G_ProveWalletAssociation</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1311" y="513">PID issuer ensures that public</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1311" y="526">key from the WUA disclosure and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1311" y="539">the public key for in the PID</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1311" y="552">to be issued come from a single</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1311" y="565">wallet</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnasmp" id="node_a_walletcanprovekeylinkage">
<title>A_WalletCanProveKeyLinkage</title>
<path class="border" d="M1536,523 a133,59,0,1,0,266,0 a133,59,0,1,0,-266,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1582" y="495">A_WalletCanProveKeyLinkage</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1582" y="513">The wallet can produce evidence</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1582" y="526">that two keys are under common</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1582" y="539">control and bound to the same</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1582" y="552">wallet instance</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1797" y="577">A</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsngoal" id="node_g_provewalletauthenticatedforattributereception">
<title>G_ProveWalletAuthenticatedForAttributeReception</title>
<path class="border" d="M1842,494 L2146,494 L2146,552 L1842,552 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1849" y="514">G_ProveWalletAuthenticatedForAttributeReception</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1849" y="532">PID issuer ensures that the authenticated wallet</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1849" y="545">is the same wallet that receives the attribute.</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnsltn" id="node_sn_useapprovedauthoritativeregisters">
<title>Sn_UseApprovedAuthoritativeRegisters</title>
<path class="border" d="M35,763 a133,133,0,1,0,266,0 a133,133,0,1,0,-266,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="54" y="735">Sn_UseApprovedAuthoritativeRegisters</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="54" y="753">PID issuer uses approved</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="54" y="766">authoritative registers and has</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="54" y="779">evidence of governance, audits and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="54" y="792">data origin</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnsltn" id="node_sn_performsubjectmatching">
<title>Sn_PerformSubjectMatching</title>
<path class="border" d="M749,763 a98,98,0,1,0,196,0 a98,98,0,1,0,-196,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="766" y="748">Sn_PerformSubjectMatching</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="766" y="766">PID issuer performs subject</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="766" y="779">matching</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnsltn" id="node_sn_manageattributevalidity">
<title>Sn_ManageAttributeValidity</title>
<path class="border" d="M1027,763 a96,96,0,1,0,192,0 a96,96,0,1,0,-192,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1044" y="748">Sn_ManageAttributeValidity</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1044" y="766">PID issuer revokes attributes</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1044" y="779">in case of non validity</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnsltn" id="node_sn_verifyproofofassociationbetweenkeys">
<title>Sn_VerifyProofOfAssociationBetweenKeys</title>
<path class="border" d="M1259,763 a141,141,0,1,0,282,0 a141,141,0,1,0,-282,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1278" y="735">Sn_VerifyProofOfAssociationBetweenKeys</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1278" y="753">PID issuer verifies a Proof of</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1278" y="766">Association (PoA) linking the WUA</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1278" y="779">disclosure public key and the fresh PID</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1278" y="792">public key</text>
</g>
<g class="gsn_module_pid_issuer gsnelem gsnsltn" id="node_sn_dpoppkce">
<title>Sn_DpopPkce</title>
<path class="border" d="M1889,763 a105,105,0,1,0,210,0 a105,105,0,1,0,-210,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1909" y="735">Sn_DpopPkce</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1909" y="753">PID issuer enforces PKCE and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1909" y="766">DPoP proofs to ensure that only</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1909" y="779">the authenticating wallet can</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1909" y="792">complete issuance</text>
</g>
<path class="gsnedge gsninspby" d="M847,558 C847,588,847,635,847,655" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M316,523 C346,523,326,523,346,523" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M168,552 C168,582,168,600,168,620" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M906,300 C906,330,645,323,645,343" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M906,300 C906,330,1697,310,1697,330" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M906,300 C906,330,116,321,116,341" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1123,545 C1123,575,1123,637,1123,657" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M1496,523 C1526,523,1506,523,1526,523" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1400,571 C1400,601,1400,592,1400,612" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1994,552 C1994,582,1994,628,1994,648" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M906,176 C906,206,906,186,906,206" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M645,411 C645,441,847,458,847,478" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M645,411 C645,441,168,464,168,484" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M645,411 C645,441,1123,471,1123,491" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1697,424 C1697,454,1400,445,1400,465" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1697,424 C1697,454,1994,464,1994,484" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M212,382 C242,382,222,382,242,382" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
</svg>