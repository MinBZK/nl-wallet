<?xml version="1.0" encoding="UTF-8"?>
<svg class="gsndiagram" viewBox="0 0 1420 914" xmlns="http://www.w3.org/2000/svg">
<defs>
<marker id="supportedby_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill="black" points="0 0, 10 4.5, 0 9"/>
</marker>
<marker id="incontextof_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill-opacity="0" points="0 0, 10 4.5, 0 9, 0 0" stroke="black" stroke-width="1"/>
</marker>
<symbol id="module_icon">
<rect fill="lightgrey" height="5" stroke="black" stroke-width="1" width="10" x="0" y="0"/>
<rect fill="lightgrey" height="10" stroke="black" stroke-width="1" width="20" x="0" y="5"/>
</symbol>
</defs>
<style type="text/css">
svg { background-color: white;}

/* CSS to invert SVG for dark mode */ 
@media (prefers-color-scheme: dark) {
    svg { filter: invert(100%); background-color: black; }
}

</style>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal" id="node_g_establishattributecorrectnessatloahigh">
<title>G_EstablishAttributeCorrectnessAtLoAHigh</title>
<path class="border" d="M609,88 L873,88 L873,158 L609,158 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="616" y="108">G_EstablishAttributeCorrectnessAtLoAHigh</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="616" y="126">RP establishes that the attribute is a</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="616" y="139">factually correct statement about the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="616" y="152">user at LoA High.</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn_checkattributestatus">
<title>Sn_CheckAttributeStatus</title>
<path class="border" d="M913,123 a103,103,0,1,0,206,0 a103,103,0,1,0,-206,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="934" y="95">Sn_CheckAttributeStatus</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="934" y="113">RP confirms that the attribute</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="934" y="126">has not expired and is not</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="934" y="139">revoked using the issuer status</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="934" y="152">endpoint</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnstgy" id="node_s_decomposeattributeverification">
<title>S_DecomposeAttributeVerification</title>
<path class="border" d="M635,266 L861,266 L847,350 L621,350 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="643" y="286">S_DecomposeAttributeVerification</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="641" y="304">Decompose into issuer trust,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="639" y="317">cryptographic integrity, verifier</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="637" y="330">validations, replay attack</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="635" y="343">prevention</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal" id="node_g_trustpidissuer">
<title>G_TrustPidIssuer</title>
<path class="border" d="M126,458 L298,458 L298,580 L126,580 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="133" y="478">G_TrustPidIssuer</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="496">RP trusts the PID issuer to (1)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="509">issue only to wallets that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="522">implement Sole Control, (2)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="535">issue only attributes that it</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="548">has checked to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="561">correct, (3) issue the PID at</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="574">LoA High</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnasmp" id="node_a_solecontrolisrequired">
<title>A_SoleControlIsRequired</title>
<path class="border" d="M338,519 a112,59,0,1,0,224,0 a112,59,0,1,0,-224,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="378" y="491">A_SoleControlIsRequired</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="378" y="509">Sole control by the user is</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="378" y="522">necessary for factual</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="378" y="535">correctness and to prevent</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="378" y="548">unauthorized use.</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="557" y="573">A</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal" id="node_g_verifypidcryptographicintegrity">
<title>G_VerifyPidCryptographicIntegrity</title>
<path class="border" d="M602,477 L812,477 L812,561 L602,561 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="609" y="497">G_VerifyPidCryptographicIntegrity</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="609" y="515">RP enforces that the attribute is</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="609" y="528">contained in a PID that originates</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="609" y="541">from a trusted issuer and</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="609" y="554">maintains cryptographic integrity.</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn_checkattributepolicycompliance">
<title>Sn_CheckAttributePolicyCompliance</title>
<path class="border" d="M852,519 a125,125,0,1,0,250,0 a125,125,0,1,0,-250,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="872" y="491">Sn_CheckAttributePolicyCompliance</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="872" y="509">RP checks that the attribute</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="872" y="522">satisfies policy requirements (PID</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="872" y="535">doctype or VCT, required claims,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="872" y="548">no over-disclosure)</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn_preventreplayandimpersonation">
<title>Sn_PreventReplayAndImpersonation</title>
<path class="border" d="M1142,519 a129,129,0,1,0,258,0 a129,129,0,1,0,-258,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1166" y="478">Sn_PreventReplayAndImpersonation</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1166" y="496">RP verifies that the presenting</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1166" y="509">wallet is the wallet the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1166" y="522">attribute was issued to using a</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1166" y="535">liveness challenge-response</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1166" y="548">mechanism (OpenID4VP or ISO</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1166" y="561">18013-5)</text>
</g>
<a href="PID_issuer.gsn.svg#node_g_issuepidatloahigh">
<g class="gsn_module_pid_issuer gsnelem gsnawaygoal" id="node_g_issuepidatloahigh">
<title>G_IssuePidAtLoAHigh</title>
<path class="border" d="M20,823 V732 H192 V823" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="27" y="752">G_IssuePidAtLoAHigh</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="770">PID issuer issues at LoA High</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="783">and issues only attributes that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="796">it knows to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="809">correct</text>
<a href="PID_issuer.gsn.svg#node_g_issuepidatloahigh">
<path class="border" d="M20,823 H192 v27 H20 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="54" y="843">pid_issuer</text>
</a>
<use href="#module_icon" x="27" y="830"/>
</g>
</a>
<a href="sole-control.gsn.svg#node_g_solecontrol">
<g class="gsn_module_sole_control_main gsnelem gsnawaygoal" id="node_g_solecontrol">
<title>G_SoleControl</title>
<path class="border" d="M232,816 V739 H406 V816" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="239" y="759">G_SoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="239" y="777">PID issuer has assurance that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="239" y="790">User will have sole control</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="239" y="803">over the PID</text>
<a href="sole-control.gsn.svg#node_g_solecontrol">
<path class="border" d="M232,816 H406 v27 H232 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="266" y="836">sole_control_main</text>
</a>
<use href="#module_icon" x="239" y="823"/>
</g>
</a>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn_verifyissuercertificate">
<title>Sn_VerifyIssuerCertificate</title>
<path class="border" d="M483,791 a102,102,0,1,0,204,0 a102,102,0,1,0,-204,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="507" y="757">Sn_VerifyIssuerCertificate</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="507" y="775">RP parses the issuer</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="507" y="788">certificate from the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="507" y="801">attestation and verifies it</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="507" y="814">against its trusted CA store of</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="507" y="827">PID issuers</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn_verifyissuersignature">
<title>Sn_VerifyIssuerSignature</title>
<path class="border" d="M727,791 a103,103,0,1,0,206,0 a103,103,0,1,0,-206,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="748" y="763">Sn_VerifyIssuerSignature</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="748" y="781">RP verifies the issuer</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="748" y="794">signature over the attributes</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="748" y="807">using the PID issuer public key</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="748" y="820">from its certificate</text>
</g>
<path class="gsnedge gsninspby" d="M741,158 C741,188,741,236,741,256" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M298,519 C328,519,308,519,328,519" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M212,580 C212,610,106,702,106,722" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M212,580 C212,610,319,709,319,729" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M707,561 C707,591,585,659,585,679" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M707,561 C707,591,830,658,830,678" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M741,350 C741,380,212,428,212,448" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M741,350 C741,380,707,447,707,467" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M741,350 C741,380,977,364,977,384" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M741,350 C741,380,1271,360,1271,380" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
</svg>