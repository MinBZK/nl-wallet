<?xml version="1.0" encoding="UTF-8"?>
<svg class="gsndiagram" viewBox="0 0 1595 970" xmlns="http://www.w3.org/2000/svg">
<defs>
<marker id="supportedby_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill="black" points="0 0, 10 4.5, 0 9"/>
</marker>
</defs>
<style type="text/css">
svg { background-color: white;}

/* CSS to invert SVG for dark mode */ 
@media (prefers-color-scheme: dark) {
    svg { filter: invert(100%); background-color: black; }
}

</style>
<a href="sole-control-2fa.gsn.svg#node_s_registerenrollment">
<g class="gsn_module_sole_control_2fa gsnelem gsnstgy" id="node_s_registerenrollment">
<title>S_RegisterEnrollment</title>
<path class="border" d="M639,20 L847,20 L833,78 L625,78 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="646" y="40">S_RegisterEnrollment</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="643" y="58">Register possession &amp; knowledge</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="640" y="71">factors via enrollment message</text>
</g>
</a>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsngoal" id="node_g_enrollmentfreshness">
<title>G_EnrollmentFreshness</title>
<path class="border" d="M40,118 L202,118 L202,176 L40,176 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="47" y="138">G_EnrollmentFreshness</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="47" y="156">Enrollment proves message</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="47" y="169">freshness</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsngoal" id="node_g_walletregistersknowledgefactor">
<title>G_WalletRegistersKnowledgeFactor</title>
<path class="border" d="M354,118 L574,118 L574,176 L354,176 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="361" y="138">G_WalletRegistersKnowledgeFactor</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="361" y="156">Wallet registers knowledge factor</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="361" y="169">at WB</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsngoal" id="node_g_walletregisterspossesionfactor">
<title>G_WalletRegistersPossesionFactor</title>
<path class="border" d="M864,118 L1080,118 L1080,176 L864,176 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="871" y="138">G_WalletRegistersPossesionFactor</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="871" y="156">Wallet registers possession</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="871" y="169">factor at WB</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsngoal" id="node_g_wbverifiesapp">
<title>G_WbVerifiesApp</title>
<path class="border" d="M1264,118 L1440,118 L1440,176 L1264,176 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1271" y="138">G_WbVerifiesApp</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1271" y="156">WB verifies that NL Wallet app</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1271" y="169">runs on a trustworthy device</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_wbprovidesnonce">
<title>Sn_WbProvidesNonce</title>
<path class="border" d="M20,330 a101,101,0,1,0,202,0 a101,101,0,1,0,-202,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="38" y="309">Sn_WbProvidesNonce</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="38" y="327">WB provides unique nonce for</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="38" y="340">enrollment, and Wallet includes</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="38" y="353">it in enrollment message</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnstgy" id="node_s_pinkey">
<title>S_PinKey</title>
<path class="border" d="M269,301 L443,301 L429,359 L255,359 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="276" y="321">S_PinKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="273" y="339">Derive PIN private key from</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="270" y="352">stored salt + PIN</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_walletregisterspinpubkey">
<title>Sn_WalletRegistersPinPubKey</title>
<path class="border" d="M476,330 a104,104,0,1,0,208,0 a104,104,0,1,0,-208,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="493" y="315">Sn_WalletRegistersPinPubKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="493" y="333">Wallet includes PinPublicKey in</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="493" y="346">enrollment message</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_walletgenerateshwboundkey">
<title>Sn_WalletGeneratesHwBoundKey</title>
<path class="border" d="M724,330 a114,114,0,1,0,228,0 a114,114,0,1,0,-228,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="742" y="309">Sn_WalletGeneratesHwBoundKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="742" y="327">Wallet generates SE/TEE-bound</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="742" y="340">HwPrivateKey plus Key</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="742" y="353">Attestation</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_walletregistershwboundkey">
<title>Sn_WalletRegistersHwBoundKey</title>
<path class="border" d="M992,330 a114,114,0,1,0,228,0 a114,114,0,1,0,-228,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1012" y="302">Sn_WalletRegistersHwBoundKey</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1012" y="320">Wallet includes</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1012" y="333">HwBoundPublicKey including Key</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1012" y="346">Attestation in enrollment</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1012" y="359">message</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnstgy" id="node_s_useappattestations">
<title>S_UseAppAttestations</title>
<path class="border" d="M1267,295 L1451,295 L1437,365 L1253,365 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1274" y="315">S_UseAppAttestations</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1272" y="333">Use platform app attestations</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1270" y="346">to verify app and device</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1268" y="359">integrity</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_walletasksforpin">
<title>Sn_WalletAsksForPin</title>
<path class="border" d="M62,598 a79,79,0,1,0,158,0 a79,79,0,1,0,-158,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="77" y="590">Sn_WalletAsksForPin</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="77" y="608">Wallet asks user for PIN</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsngoal" id="node_g_pinhasminentropy">
<title>G_PinHasMinEntropy</title>
<path class="border" d="M260,569 L422,569 L422,627 L260,627 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="267" y="589">G_PinHasMinEntropy</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="267" y="607">PIN has minimum entropy &amp;</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="267" y="620">complexity</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_walletgeneratessalt">
<title>Sn_WalletGeneratesSalt</title>
<path class="border" d="M462,598 a96,96,0,1,0,192,0 a96,96,0,1,0,-192,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="479" y="583">Sn_WalletGeneratesSalt</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="479" y="601">Wallet generates and stores a</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="479" y="614">random salt</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_walletprovidesappattestation">
<title>Sn_WalletProvidesAppAttestation</title>
<path class="border" d="M1113,598 a114,114,0,1,0,228,0 a114,114,0,1,0,-228,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1131" y="577">Sn_WalletProvidesAppAttestation</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1131" y="595">Wallet provides platform app</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1131" y="608">attestation in enrollment</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1131" y="621">message</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_wbvalidatesattestations">
<title>Sn_WbValidatesAttestations</title>
<path class="border" d="M1381,598 a97,97,0,1,0,194,0 a97,97,0,1,0,-194,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1397" y="583">Sn_WbValidatesAttestations</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1397" y="601">WB validates app &amp; key</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1397" y="614">attestations</text>
</g>
<g class="gsn_module_sole_control_2fa_registration gsnelem gsnsltn" id="node_sn_pincomplexity">
<title>Sn_PinComplexity</title>
<path class="border" d="M242,851 a99,99,0,1,0,198,0 a99,99,0,1,0,-198,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="258" y="836">Sn_PinComplexity</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="258" y="854">Wallet enforces PIN complexity</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="258" y="867">rules</text>
</g>
<path class="gsnedge gsninspby" d="M121,176 C121,206,121,199,121,219" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M341,627 C341,657,341,722,341,742" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M464,176 C464,206,349,271,349,291" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M464,176 C464,206,580,196,580,216" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M972,176 C972,206,838,186,838,206" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M972,176 C972,206,1106,186,1106,206" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1352,176 C1352,206,1352,265,1352,285" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M349,359 C349,389,341,539,341,559" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M349,359 C349,389,141,489,141,509" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M349,359 C349,389,558,472,558,492" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M736,78 C736,108,121,88,121,108" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M736,78 C736,108,464,88,464,108" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M736,78 C736,108,972,88,972,108" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M736,78 C736,108,1352,88,1352,108" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1352,365 C1352,395,1227,454,1227,474" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M1352,365 C1352,395,1478,471,1478,491" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
</svg>