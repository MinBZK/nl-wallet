<?xml version="1.0" encoding="UTF-8"?>
<svg class="gsndiagram" viewBox="0 0 1504 744" xmlns="http://www.w3.org/2000/svg">
<defs>
<marker id="supportedby_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill="black" points="0 0, 10 4.5, 0 9"/>
</marker>
<marker id="incontextof_arrow" markerHeight="9" markerUnits="userSpaceOnUse" markerWidth="10" orient="auto-start-reverse" refX="0" refY="4.5">
<polyline fill-opacity="0" points="0 0, 10 4.5, 0 9, 0 0" stroke="black" stroke-width="1"/>
</marker>
<symbol id="module_icon">
<rect fill="lightgrey" height="5" stroke="black" stroke-width="1" width="10" x="0" y="0"/>
<rect fill="lightgrey" height="10" stroke="black" stroke-width="1" width="20" x="0" y="5"/>
</symbol>
</defs>
<style type="text/css">
svg { background-color: white;}

/* CSS to invert SVG for dark mode */ 
@media (prefers-color-scheme: dark) {
    svg { filter: invert(100%); background-color: black; }
}

</style>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal" id="node_g1">
<title>G1</title>
<path class="border" d="M715,20 L875,20 L875,104 L715,104 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="722" y="40">G1</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="722" y="58">RP establishes that the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="722" y="71">attribute is a factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="722" y="84">correct statement about the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="722" y="97">user at LoA High.</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnstgy" id="node_s1">
<title>S1</title>
<path class="border" d="M712,144 L892,144 L878,228 L698,228 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="719" y="164">S1</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="717" y="182">Decompose into issuer trust,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="715" y="195">cryptographic integrity,</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="713" y="208">verifier validations, replay</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="711" y="221">attack preventions</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal" id="node_g1_1">
<title>G1.1</title>
<path class="border" d="M126,313 L298,313 L298,435 L126,435 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="133" y="333">G1.1</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="351">RP trusts the PID issuer to (1)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="364">issue only to wallets that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="377">implement Sole Control, (2)</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="390">issue only attributes that it</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="403">has checked to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="416">correct, (3) issue the PID at</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="133" y="429">LoA High</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnasmp" id="node_a1_1">
<title>A1.1</title>
<path class="border" d="M338,374 a107,59,0,1,0,214,0 a107,59,0,1,0,-214,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="376" y="346">A1.1</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="376" y="364">Sole control by the user is</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="376" y="377">necessary for factual</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="376" y="390">correctness and prevent</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="376" y="403">unauthorized use.</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="547" y="428">A</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal" id="node_g1_2">
<title>G1.2</title>
<path class="border" d="M592,326 L762,326 L762,422 L592,422 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="599" y="346">G1.2</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="599" y="364">RP enforces that the attribute</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="599" y="377">is contained in a PID that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="599" y="390">originates from a trusted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="599" y="403">issuer and maintains</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="599" y="416">cryptographic integrity.</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn1_2_1">
<title>Sn1.2.1</title>
<path class="border" d="M802,374 a96,96,0,1,0,192,0 a96,96,0,1,0,-192,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="823" y="346">Sn1.2.1</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="823" y="364">RP checks that the attribute</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="823" y="377">satisfies policy requirements</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="823" y="390">(PID doctype/vct, required</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="823" y="403">claims, no over-disclosure).</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn1_2_2">
<title>Sn1.2.2</title>
<path class="border" d="M1034,374 a99,99,0,1,0,198,0 a99,99,0,1,0,-198,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1056" y="346">Sn1.2.2</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1056" y="364">RP confirms that the attribute</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1056" y="377">has not expired and is not</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1056" y="390">revoked using the issuer's</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1056" y="403">status endpoint.</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn1_2_3">
<title>Sn1.2.3</title>
<path class="border" d="M1272,374 a106,106,0,1,0,212,0 a106,106,0,1,0,-212,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="1299" y="333">Sn1.2.3</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1299" y="351">RP checks that the wallet that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1299" y="364">presents the attribute is the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1299" y="377">wallet it was issued to using</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1299" y="390">liveness check</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1299" y="403">(challenge/response) from</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="1299" y="416">OpenID4VP or ISO 18013-5</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsngoal gsn_undeveloped" id="node_g1_4">
<title>G1.4</title>
<path class="border" d="M20,578 L192,578 L192,666 L20,666 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="27" y="598">G1.4</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="616">PID issuer issues at LoA High</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="629">and issues only attributes that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="642">it knows to be factually</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="27" y="655">correct</text>
<path d="M106,666 l5,5 l-5,5 l-5,-5 z" fill-opacity="0" stroke="black" stroke-width="1"/>
</g>
<a href="sole-control.gsn.svg#node_g_solecontrol">
<g class="gsn_module_sole_control_main gsnelem gsnawaygoal" id="node_g_solecontrol">
<title>G_SoleControl</title>
<path class="border" d="M232,647 V570 H406 V647" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="239" y="590">G_SoleControl</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="239" y="608">PID issuer has assurance that</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="239" y="621">User will have sole control</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="239" y="634">over the PID</text>
<a href="sole-control.gsn.svg#node_g_solecontrol">
<path class="border" d="M232,647 H406 v27 H232 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="266" y="667">sole_control_main</text>
</a>
<use href="#module_icon" x="239" y="654"/>
</g>
</a>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn1_1">
<title>Sn1.1</title>
<path class="border" d="M456,622 a102,102,0,1,0,204,0 a102,102,0,1,0,-204,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="480" y="588">Sn1.1</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="480" y="606">RP parses the the issuer's</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="480" y="619">certificate out of the</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="480" y="632">attestation and verifies it</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="480" y="645">against its CA store of trusted</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="480" y="658">PID issuers</text>
</g>
<g class="gsn_module_rp_session_attribute gsnelem gsnsltn" id="node_sn1_2">
<title>Sn1.2</title>
<path class="border" d="M700,622 a97,97,0,1,0,194,0 a97,97,0,1,0,-194,0 z" fill-opacity="0" stroke="black" stroke-width="1"/>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" font-weight="bold" x="721" y="594">Sn1.2</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="721" y="612">RP verifies the issuer</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="721" y="625">signature over the attributes</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="721" y="638">against the PID issuer public</text>
<text font-family="Liberation Sans, Arial, sans-serif" font-size="12px" x="721" y="651">key from its certificate</text>
</g>
<path class="gsnedge gsninspby" d="M795,104 C795,134,795,114,795,134" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninctxt" d="M298,374 C328,374,308,374,328,374" fill-opacity="0" marker-end="url(#incontextof_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M212,435 C212,465,106,548,106,568" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M212,435 C212,465,319,540,319,560" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M677,422 C677,452,558,490,558,510" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M677,422 C677,452,797,495,797,515" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M795,228 C795,258,212,283,212,303" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M795,228 C795,258,677,296,677,316" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M795,228 C795,258,898,248,898,268" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M795,228 C795,258,1133,245,1133,265" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
<path class="gsnedge gsninspby" d="M795,228 C795,258,1378,238,1378,258" fill-opacity="0" marker-end="url(#supportedby_arrow)" stroke="black" stroke-width="1"/>
</svg>