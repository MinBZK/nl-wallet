# Use Case 5.2 Log in to Relying Party application

## Overview

| Aspect                       | Description                                                                                                                                                                                                                                                                                                |
|------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Summary**                  | The user logs in to a Relying Party by initiating the process on the Relying Party site, confirming their identity in the NL Wallet app,<br>reviewing the organization and request details, and confirming the login with PIN.                                                                             |
| **Goal**                     | Logging in to a Relying Party                                                                                                                                                                                                                                                                              |
| **Preconditions**            | <ul><li>The App holds the requested data.</li></ul>                                                                                                                                                                                                                                                        |
| **Postconditions**           | <ul><li>User is logged in at the Relying Party application.</li><li>A login event is added in the history.</li></ul>                                                                                                                                                                                       |
| **Triggered by**             | <ul><li>User invokes a universal link that contains the URL to a Relying Party.</li><li>User scans QR with in-app scanner [UC9.9 Scan QR](UC9.9_ScanQR.md)</li></ul>                                                                                                                                       |
| **Additional Documentation** | <ul><li>[Disclosure](../../architecture/disclosure-with-openid4vp.md)</li></ul>                                                                                                                                                                                                                            |
| **Possible errors**          | <ul><li>No internet</li><li>Server unreachable</li><li>Session expired</li><li>Attributes missing</li><li>Known verifier error</li><li>Unknown verifier error</li></ul>                                                                                                                                    |
| **Logical test cases**       | <ul><li>[LTC23 RP Login happy flow](../logical-test-cases.md#ltc23)</li><li>[LTC24 Cross-device login](../logical-test-cases.md#ltc24)</li><li>[LTC25 User continues after initially cancelling](../logical-test-cases.md#ltc25)</li><li>[LTC26 Disclosure fails](../logical-test-cases.md#ltc4)</li></ul> |

---

## Flow

| #       | Description                                                                                                                                                                                            | Next                                                                    |
| ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------- |
| **1**   | **PRIMARY SCENARIO**                                                                                                                                                                                   |                                                                         |
| **1.1** | **System retrieves data request from verifier and displays loading indicator**<ul><li>Message: Data is being retrieved</li><li>Actions: Stop</li><li>Duration: 0.0 - 1.0 seconds</li></ul>             |                                                                         |
| 1.1a    | Case: Cross device flow                                                                                                                                                                                | 1.2                                                                     |
| 1.1b    | Case: Same device flow                                                                                                                                                                                 | 1.3                                                                     |
| 1.1c    | Case: Wallet does not contain requested attribute                                                                                                                                                      | Error flow: Attributes missing                                          |
| 1.1d    | User selects Stop                                                                                                                                                                                      | 2                                                                       |
| 1.1e    | Error: Session expired                                                                                                                                                                                 | Error flow: Session expired                                             |
| 1.1f    | Error: No internet                                                                                                                                                                                     | Error flow: No internet                                                 |
| 1.1g    | Error: Server unreachable                                                                                                                                                                              | Error flow: Server unreachable                                          |
| 1.1h    | Error: Unknown verifier error                                                                                                                                                                          | Error flow: Unknown verifier error                                      |
| 1.1i    | Error: Known verifier error                                                                                                                                                                            | Error flow: Known verifier error                                        |
| **1.2** | **System displays screen 'Website check'**<ul><li>Message: Is the website starting with: [organization url]?</li><li>Actions: Yes continue, Stop, About the website check, Help</li></ul>              |                                                                         |
| 1.2a    | User selects Yes continue                                                                                                                                                                              | 1.3                                                                     |
| 1.2b    | User selects Stop                                                                                                                                                                                      | 2                                                                       |
| 1.2c    | User selects About the website check                                                                                                                                                                   | 3                                                                       |
| 1.2d    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| **1.3** | **System displays screen 'Approve login organization'**<ul><li>Message: Do you want to login in to [organization]?</li><li>Actions: Login, Check all details, Help, Close, Stop</li></ul>              |                                                                         |
| 1.3a    | User selects Login                                                                                                                                                                                     | 1.4                                                                     |
| 1.3b    | User selects Check all details                                                                                                                                                                         | 4                                                                       |
| 1.3e    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 1.3f    | User selects Close                                                                                                                                                                                     | 2                                                                       |
| 1.3g    | User selects Stop                                                                                                                                                                                      | 2                                                                       |
| **1.4** | **System executes partial flow [PF2.4 Confirm a protected action](../partial-flows/PF2.4_ConfirmProtectedAction.md)**<ul><li>Cancelable</li></ul>                                                                     |                                                                         |
| 1.4a    | Result: Confirm                                                                                                                                                                                        | 1.5                                                                     |
| 1.4b    | Result: Cancel                                                                                                                                                                                         | 2                                                                       |
| 1.4c    | Result: Back                                                                                                                                                                                           | Back                                                                    |
| **1.5** | **System determines User flow**<ul><li>Duration: 0.0 - 0.1 seconds</li></ul>                                                                                                                           |                                                                         |
| 1.5a    | Case: Cross device flow                                                                                                                                                                                | 1.6                                                                     |
| 1.5b    | Case: Same device flow                                                                                                                                                                                 | 1.7                                                                     |
| **1.6** | **System displays screen 'Login success'**<ul><li>Message: Success!</li><li>Actions: To my overview, See activity, Help, Close</li></ul>                                                               |                                                                         |
| 1.6a    | User selects To my overview                                                                                                                                                                            | Go to: [UC7.1 Show all available cards](UC7.1_ShowAllAvailableCards.md) |
| 1.6b    | User selects See activity                                                                                                                                                                              | Go to: [UC6.3 Show event](UC6.3_ShowHistoryEvent.md)                    |
| 1.6c    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 1.6d    | User selects Close <br>&rarr; System opens browser and suspends app                                                                                                                                    | Go to: [UC7.1 Show all available cards](UC7.1_ShowAllAvailableCards.md) |
| 1.6e    | Error: No internet                                                                                                                                                                                     | Error flow: No internet                                                 |
| 1.6f    | Error: Server unreachable                                                                                                                                                                              | Error flow: Server unreachable                                          |
| **1.7** | **System displays screen 'Login success'**<ul><li>Message: Success!</li><li>Actions: Go to website, See activity, Help, Close</li></ul>                                                                |                                                                         |
| 1.7a    | User selects Go to website <br>&rarr; System opens browser and suspends app                                                                                                                            |                                                                         |
| 1.7b    | User selects See activity                                                                                                                                                                              | Go to: [UC6.3 Show event](UC6.3_ShowHistoryEvent.md)                    |
| 1.7c    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 1.7d    | User selects Close <br>&rarr; System opens browser and suspends app                                                                                                                                    | Go to: [UC7.1 Show all available cards](UC7.1_ShowAllAvailableCards.md) |
| 1.7e    | Error: No internet                                                                                                                                                                                     | Error flow: No internet                                                 |
| 1.7f    | Error: Server unreachable                                                                                                                                                                              | Error flow: Server unreachable                                          |
| **2**   | **STOP**                                                                                                                                                                                               |                                                                         |
| **2.1** | **System displays screen 'Stop'**<ul><li>Message: Are you sure you want to stop?</li><li>Actions: Yes Stop, No, Report Problem</li></ul>                                                               |                                                                         |
| 2.1a    | User selects Yes stop                                                                                                                                                                                  |                                                                         |
| 2.1b    | User selects No                                                                                                                                                                                        | Back                                                                    |
| 2.1c    | User selects Report a problem                                                                                                                                                                          | 6                                                                       |
| **3**   | **GET WEBSITE CHECK DETAILS**                                                                                                                                                                          |                                                                         |
| **3.1** | **System displays screen 'Under construction'**<ul><li>Actions: Back</li></ul>                                                                                                                         |                                                                         |
| 3.1a    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| **4**   | **GET SHARING DETAILS**                                                                                                                                                                                |                                                                         |
| **4.1** | **System displays screen 'Approve Organization'**<ul><li>Message: Information about logging in at [organization]?</li><li>Actions: [organization], View data, Read the agreement, Help, Back</li></ul> |                                                                         |
| 4.1a    | User selects [organization]                                                                                                                                                                            | 7                                                                       |
| 4.1b    | User selects View data                                                                                                                                                                                 | 4.2                                                                     |
| 4.1c    | User selects Read the agreement                                                                                                                                                                        | 6                                                                       |
| 4.1d    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 4.1e    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| **4.2** | **System displays screen 'Requested data'**<ul><li># from [Card Title]</li><li>Actions: Details Incorrect, Help, Back</li></ul>                                                                        |                                                                         |
| 4.2a    | User selects Details Incorrect                                                                                                                                                                         | 5                                                                       |
| 4.2b    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 4.2c    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| **5**   | **WHEN DETAILS ARE INCORRECT**                                                                                                                                                                         |                                                                         |
| **5.1** | **System displays screen 'Details incorrect'**<ul><li>Message: Details Incorrect</li><li>Actions: Back</li></ul>                                                                                       |                                                                         |
| 5.1a    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| **6**   | **GET SHARING AGREEMENT DETAILS**                                                                                                                                                                      |                                                                         |
| **6.2** | **System displays screen 'Agreements'**<ul><li>Message: agreements</li><li>Actions: Privacy policy, Back</li></ul>                                                                                     |                                                                         |
| 6.2a    | User selects Privacy policy <br>&rarr; System opens browser and suspends app                                                                                                                           |                                                                         |
| 6.2b    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| **7**   | **GET VERIFIER ORGANIZATION DETAILS**                                                                                                                                                                  |                                                                         |
| **7.1** | **System displays screen 'About organization'**<ul><li>Message: About [Organization]</li><li>Actions: Help, Back</li></ul>                                                                             |                                                                         |
| 7.1a    | User selects Help                                                                                                                                                                                      | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 7.1b    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| **8**   | **REPORT PROBLEM**                                                                                                                                                                                     |                                                                         |
| **8.1** | **System displays screen 'Report problem'**<ul><li>Message: Report Problem</li><li>Options: problems</li><li>Actions: Back</li></ul>                                                                   |                                                                         |
| 8.1a    | User selects Back                                                                                                                                                                                      | Back                                                                    |
| 8.1b    | User selects Problem option                                                                                                                                                                            | 8.2                                                                     |
| **8.2** | **System displays screen 'Under construction'**<ul><li>Actions: Back</li></ul>                                                                                                                         |                                                                         |
| 8.2a    | User selects Back                                                                                                                                                                                      | 8.1                                                                     |