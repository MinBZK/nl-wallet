# Use Case 3.1 Obtain PID

## Overview

| Aspect                       | Description                                                                                                                                                                                                                                                                                                   |
|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Summary**                  | The user obtains Person Identification Data (PID) by first authenticating themselves using DigiD (with ID card or driver's license),<br>checking the offered PID and entering their PIN to complete the process.                                                                                              |
| **Goal**                     | Obtaining the Person Identification Data (PID) to personalize the App.                                                                                                                                                                                                                                        |
| **Preconditions**            | <ul><li>The User has an instance of DigiD, activated at Level of Assurance High, on a device with an NFC scanner.</li><li>The User has their ID card or driver's license with them.</li></ul>                                                                                                                 |
| **Postconditions**           | <ul><li>PID is issued to and stored in the App.</li><li>The PID issuance event is added in the history.</li></ul>                                                                                                                                                                                             |
| **Triggered by**             | <ul><li>User completes [UC2.3 Setup remote pin and biometrics](UC2.1_SetupRemotePinAndBiometricsUnlock.md)</li><li>User completes [UC2.3 Unlock the app](UC2.3_UnlockTheApp.md) when app is not personalized.</li></ul>                                                                                       |
| **Additional Documentation** | <ul><li>[Issuance](../../architecture/issuance-with-openid4vci.md)</li></ul>                                                                                                                                                                                                                                  |
| **Possible errors**          | <ul><li>No internet</li><li>Server unreachable</li><li>Device incompatible</ul><li>Generic</ul></li>                                                                                                                                                                                                          |
| **Logical test cases**       | <ul><li>[LTC1 PID issuance happy flow](../logical-test-cases.md#ltc1)</li><li>[LTC2 Issuance fails](../logical-test-cases.md#ltc2)</li><li>[LTC3 Authentication with auth server fails](../logical-test-cases.md#ltc3)</li><li>[LTC4 User rejects issued attributes](../logical-test-cases.md#ltc4)</li></ul> |

---

## Flow

| #       | Description                                                                                                                                                              | Next                                                                   |
| ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------- |
| **1**   | **PRIMARY SCENARIO**                                                                                                                                                     |                                                                        |
| **1.1** | **System displays screen 'Add cards via DigiD'**<ul><li>Message: Use DigiD to prove who you are</li><li>Actions: Open the DigiD app, Go to Digid website, Help</li></ul> |                                                                        |
| 1.1a    | User selects Open the DigiD app                                                                                                                                          | 1.2                                                                    |
| 1.1b    | User selects Go to DigiD website <br>&rarr; System opens DigiD website in browser and suspends app                                                                       |                                                                        |
| 1.1c    | User selects Help                                                                                                                                                        | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                              |
| **1.2** | **System awaits DigiD response and displays screen 'Continue with DigiD'**<ul><li>Message: Continue in DigiD app to get your data</li><li>Actions: Stop</li></ul>        |                                                                        |
| 1.2a    | Event: DigiD returns control to System, authentication successful                                                                                                        | 1.3                                                                    |
| 1.2b    | Event: DigiD returns control to System, authentication failed                                                                                                            | 2                                                                      |
| 1.2c    | Event: DigiD returns control to System, login stopped or session expired                                                                                                 | 3                                                                      |
| 1.2d    | User selects Stop                                                                                                                                                        | 4                                                                      |
| **1.3** | **System executes PID issuance until preview**<ul><li>Data is being retrieved</li><li>Actions: Stop</li><li>Duration: 0.1 - 1.5 seconds</li></ul>                        |                                                                        |
| 1.3a    | Event: PID issuance completes successfully                                                                                                                               | 1.4                                                                    |
| 1.3b    | Error: PID could not be issued successfully                                                                                                                              | Error flow: Generic                                                    |
| 1.3c    | Error: No internet                                                                                                                                                       | Error flow: No internet                                                |
| 1.3d    | Error: Server unreachable                                                                                                                                                | Error flow: Server unreachable                                         |
| **1.4** | **System displays screen 'Verify your data'**<ul><li>Message: Are your details correct?</li><li>Actions: Add, No</li></ul>                                               |                                                                        |
| 1.4a    | User selects Add                                                                                                                                                         | 1.5                                                                    |
| 1.4b    | User selects No                                                                                                                                                          | 6                                                                      |
| **1.5** | **System executes partial flow [PF2.4 Confirm a protected action](../partial-flows/PF2.4_ConfirmProtectedAction.md)**<ul><li>Not cancelable</li></ul>                                   |                                                                        |
| 1.5a    | Result: Confirm                                                                                                                                                          | 1.6                                                                    |
| 1.5b    | Result: Back                                                                                                                                                             | 1.4                                                                    |
| **1.6** | **System executes rest of PID issuance**<ul><li>Duration: 0.1 - 1.5 seconds</li></ul>                                                                                    |                                                                        |
| 1.6a    | Event: PID issuance completes successfully                                                                                                                               | 1.7                                                                    |
| 1.6b    | Error: No internet                                                                                                                                                       | Error flow: No internet                                                |
| 1.6c    | Error: Server unreachable                                                                                                                                                | Error flow: Server unreachable                                         |
| **1.7** | **System displays screen 'Wallet is ready'**<ul><li>Message: Your NL Wallet is ready</li><li>Actions: To my overview</li></ul>                                           |                                                                        |
| 1.7a    | User selects To my overview                                                                                                                                              | Go to: [UC7.1 Show all available cards](./UC7.1_ShowAllAvailableCards) |
| **2**   | **WHEN DIGID AUTHENTICATION FAILS**                                                                                                                                      |                                                                        |
| **2.1** | **System displays screen 'Login failed'**<ul><li>Message: Login again to get data</li><li>Actions: Login again, Go to DigiD website</li></ul>                            |                                                                        |
| 2.1a    | User selects Login again                                                                                                                                                 | 1.2                                                                    |
| 2.2b    | User selects Go to DigiD website <br>&rarr; System opens DigiD website in browser and suspends app                                                                       |                                                                        |
| **3**   | **WHEN USER ABORTS OR EXPIRES**                                                                                                                                          |                                                                        |
| **3.1** | **System displays screen 'Login stopped'**<ul><li>Message: To continue login again</li><li>Actions: Login again, Go to DigiD website</li></ul>                           |                                                                        |
| 3.1a    | User selects Login again                                                                                                                                                 | Back                                                                   |
| 3.1b    | User selects Go to DigiD website                                                                                                                                         |                                                                        |
| **4**   | **WHEN USER ABORTS DIGID FROM APP**                                                                                                                                      |                                                                        |
| **4.1** | **System displays prompt 'Are you sure?'**<ul><li>Actions: Back, Stop Login</li></ul>                                                                                    |                                                                        |
| 4.1a    | User selects Back                                                                                                                                                        | Back                                                                   |
| 4.1b    | User selects Stop Login                                                                                                                                                  | 4.2                                                                    |
| **4.2** | **System displays screen 'Login stopped'**<ul><li>Actions: Login again, Go to DigiD website</li></ul>                                                                    |                                                                        |
| 4.2a    | User selects Login again                                                                                                                                                 | 1.2                                                                    |
| 4.2b    | User selects Go to DigiD website <br>&rarr; System opens browser and suspends app                                                                                        |                                                                        |
| **5**   | **WHEN PID ISSUANCE FAILS**                                                                                                                                              |                                                                        |
| **5.1** | **System displays screen 'Details are incorrect'**<ul><li>Message: Details Incorrect</li><li>Actions: Stop, Back</li></ul>                                               |                                                                        |
| 5.1a    | User selects Stop                                                                                                                                                        | 1.1                                                                    |
| 5.1b    | User selects Back                                                                                                                                                        | Back                                                                   |
| **6**   | **WHEN USER REJECTS ISSUED PID**                                                                                                                                         |                                                                        |
| **6.1** | **System displays screen 'Details are incorrect'**<ul><li>Message: Details Incorrect</li><li>Actions: Stop, Back</li></ul>                                               |                                                                        |
| 6.1a    | User selects Stop                                                                                                                                                        | 1.1                                                                    |
| 6.1b    | User selects Back                                                                                                                                                        | Back                                                                   |