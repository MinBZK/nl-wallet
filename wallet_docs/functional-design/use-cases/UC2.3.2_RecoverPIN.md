# Use Case 2.3.2 Recover PIN

## Overview

| Aspect                       | Description                                                                                                                                                                                                                                       |
|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Summary**                  | The user forgets PIN, then authenticates at DigiD and choosing and confirming a new PIN that meets policy requirements.                                                                                                                           |
| **Goal**                     | Recover from a forgotten remote PIN and regain access to the app.                                                                                                                                                                                 |
| **Preconditions**            | *None*                                                                                                                                                                                                                                            |
| **Postconditions**           | <ul><li>User has regained access and can use the new PIN in the Wallet.</li><li>Old PIN can not be used anymore.</li></ul>                                                                                                                        |
| **Triggered by**             | <ul><li>User selects 'Forgot PIN' in [PF2.4 Confirm a protected action](../partial-flows/PF2.4_ConfirmProtectedAction.md), [PF2.8 Validate PIN](../partial-flows/PF2.8_ValidatePin.md) or [UC2.3 Unlock the app](UC2.3_UnlockTheApp.md)</li></ul> |
| **Additional Documentation** | <ul><li>[PIN validation](../../architecture/use-cases/pin-validation)</li></ul>                                                                                                                                                                   |
| **Possible errors**          | *None*                                                                                                                                                                                                                                            |
| **Logical Test Cases**       | <ul><li>[LTC83 Recover PIN Happy flow](../logical-test-cases.md#ltc83)</li></ul>                                                                                                                                                                  |

---

## Flow

| #       | Description                                                                                                                                                               | Next                                                                    |
|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
| **1**   | **PRIMARY SCENARIO**                                                                                                                                                      |                                                                         |
| **1.1** | **Displays screen 'Forgot PIN'**<ul><li>Message: Create a new PIN to regain access</li><li>Actions: Forgot PIN, Back, Help </li></ul>                                     |                                                                         |
| 1.1a    | User selects Forgot PIN                                                                                                                                                   | 1.2                                                                     |
| 1.1b    | User selects Back                                                                                                                                                         | Back                                                                    |
| 1.1c    | User selects Help                                                                                                                                                         | Show placeholder 'under construction'                                   |
| **1.2** | **Displays screen 'Login with DigiD'**<ul><li>Message: This way you can create a new PIN</li>li>Actions: Open the DigiD app, To DigiD website, Back, Help</li></ul>       |                                                                         |
| 1.2a    | User selects Open the DigiD app                                                                                                                                           | 1.3                                                                     |
| 1.2b    | User selects To DigiD website <br>&rarr; System opens DigiD website in browser and suspends app                                                                           |                                                                         |
| 1.2c    | User selects Back                                                                                                                                                         | Back                                                                    |
| 1.2d    | User selects Help                                                                                                                                                         | Show placeholder 'under construction'                                   |
| **1.3** | **System awaits DigiD response and displays screen 'Continue with DigiD'**<ul><li>Message: Continue in DigiD app to get your data</li><li>Actions: Stop</li></ul>         |                                                                         |
| 1.3a    | Event: DigiD returns control to System, authentication successful                                                                                                         | 1.4                                                                     |
| 1.3b    | Event: DigiD returns control to System, authentication failed                                                                                                             | 2                                                                       |
| 1.3c    | Event: DigiD returns control to System, login stopped or session expired                                                                                                  | 3                                                                       |
| 1.3d    | Event: DigiD returns control to System, wrong DigiD account                                                                                                               | 4                                                                       |
| 1.3e    | User selects Stop                                                                                                                                                         | 5                                                                       |
| **1.4** | **System executes partial flow [PF2.9 Setup PIN](../partial-flows/PF2.9_SetupPin.md)**<ul><li>Cancelable</li></ul>                                                        |                                                                         |
| 1.4a    | Result: PIN setup succeeds                                                                                                                                                | 1.5                                                                     |
| 1.4b    | Result: Back                                                                                                                                                              | Back                                                                    |
| 1.4c    | Result: Stop                                                                                                                                                              | 1.2                                                                     |
| **1.5** | **System displays screen 'You have access again'**<ul><li>Message: Remember your PIN</li><li>Actions: To my overview, See activity</li></ul>                              |                                                                         |
| 1.5a    | User selects To my overview                                                                                                                                               | Go to: [UC7.1 Show all avail able cards](./UC7.1_ShowAllAvailableCards) |
| 1.5b    | User selects See activity                                                                                                                                                 | Go to: [UC6.3 Show event](UC6.3_ShowHistoryEvent.md)                    |
| **2**   | **WHEN DIGID AUTHENTICATION FAILS**                                                                                                                                       |                                                                         |
| **2.1** | **System displays screen 'Login failed'**<ul><li>Message: Login again to get data</li><li>Actions: Login again, Go to DigiD website</li></ul>                             |                                                                         |
| 2.1a    | User selects Login again                                                                                                                                                  | 1.3                                                                     |
| 2.2b    | User selects Go to DigiD website <br>&rarr; System opens DigiD website in browser and suspends app                                                                        |                                                                         |
| **3**   | **WHEN USER ABORTS OR EXPIRES**                                                                                                                                           |                                                                         |
| **3.1** | **System displays screen 'Login stopped'**<ul><li>Message: To continue login again</li><li>Actions: Login again, Go to DigiD website</li></ul>                            |                                                                         |
| 3.1a    | User selects Login again                                                                                                                                                  | Back                                                                    |
| 3.1b    | User selects Go to DigiD website                                                                                                                                          |                                                                         |
| **4**   | **WHEN USER LOGS IN WITH WRONG DIGID ACCOUNT**                                                                                                                            |                                                                         |
| **4.1** | **System displays screen 'Wrong DigiD'**<ul><li>Message: This NL Wallet does not belong to this DigiD account</li><li>Actions: Login again, Go to DigiD website</li></ul> |                                                                         |
| 4.1a    | User selects Login again                                                                                                                                                  | 1.3                                                                     |
| 4.2b    | User selects Go to DigiD website <br>&rarr; System opens DigiD website in browser and suspends app                                                                        |                                                                         |
| **5**   | **WHEN USER ABORTS DIGID FROM APP**                                                                                                                                       |                                                                         |
| **5.1** | **System displays prompt 'Stop DigiD login?'**<ul><li>Actions: Cancel, Stop Login</li></ul>                                                                               |                                                                         |
| 5.1a    | User selects Cancel                                                                                                                                                       | Back                                                                    |
| 5.1b    | User selects Stop Login                                                                                                                                                   | 4.2                                                                     |
| **5.2** | **System displays screen 'Login stopped'**<ul><li>Actions: Login again, Go to DigiD website</li></ul>                                                                     |                                                                         |
| 5.2a    | User selects Login again                                                                                                                                                  | 1.3                                                                     |
| 5.2b    | User selects Go to DigiD website <br>&rarr; System opens browser and suspends app                                                                                         |                                                                         |
