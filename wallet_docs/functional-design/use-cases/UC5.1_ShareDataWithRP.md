# Use Case 5.1 Share data with a Relying Party

## Overview

| Aspect                       | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Summary**                  | The user shares personal data with a Relying Party by initiating the process on the Relying Party site, confirming their identity in the NL Wallet app,<br>reviewing organization and data details, and then confirming the disclosure with PIN.                                                                                                                                                                                                                                                                                                                                                       |
| **Goal**                     | Share data with a Relying Party.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Preconditions**            | <ul><li>The App holds the requested data.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Postconditions**           | <ul><li>Data is shared with Relying Party.</li><li>The disclosure event is added in the history.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Triggered by**             | <ul><li>User invokes a universal link that contains the URL to a Relying Party.</li><li>User scans QR with in-app scanner [UC9.9 Scan QR](UC9.9_ScanQR.md)</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Additional Documentation** | <ul><li>[Disclosure with openidp4vp](../../architecture/disclosure-with-openid4vp.md)</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Possible errors**          | <ul><li>No internet</li><li>Server unreachable</li><li>Session expired</li><li>Attributes missing</li><li>Known verifier error</li><li>Unknown verifier error</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Logical test cases**       | <ul><li>[LTC17 Share data happy flow](../logical-test-cases.md#ltc17)</li><li>[LTC18 Cross-device share data](../logical-test-cases.md#ltc18)</li><li>[LTC19 User does not give consent to share data](../logical-test-cases.md#ltc19)</li><li>[LTC20 User stops at Share data approve organization](../logical-test-cases.md#ltc20)</li><li>[LTC21 User continues after initially cancelling](../logical-test-cases.md#ltc21)</li><li>[LTC26 Disclosure fails](../logical-test-cases.md#ltc26)</li><li>[LTC27 Wallet does not contain requested attributes](../logical-test-cases.md#ltc27)</li></ul> |

---

## Flow

| #       | Description                                                                                                                                                                                                   | Next                                                                    |
| ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| **1**   | **PRIMARY SCENARIO**                                                                                                                                                                                          |                                                                         |
| **1.1** | **System retrieves data request from verifier and displays loading indicator**<ul><li>Message: Data is being retrieved</li><li>Actions: Stop</li><li>Duration: 0.0 - 1.0 seconds</li></ul>                    |                                                                         |
| 1.1a    | Case: Requested data is available in wallet (cross-device flow)                                                                                                                                               | 1.2                                                                     |
| 1.1b    | Case: Requested data is available in wallet (same-device flow)                                                                                                                                                | 1.3                                                                     |
| 1.1c    | Case: Wallet does not contain requested attribute                                                                                                                                                             | Error flow: Attributes missing                                          |
| 1.1d    | User selects Stop                                                                                                                                                                                             | 2                                                                       |
| 1.1e    | Error: Session expired                                                                                                                                                                                        | Error flow: Session expired                                             |
| 1.1f    | Error: No internet                                                                                                                                                                                            | Error flow: No internet                                                 |
| 1.1g    | Error: Server unreachable                                                                                                                                                                                     | Error flow: Server unreachable                                          |
| 1.1h    | Error: Unknown verifier error                                                                                                                                                                                 | Error flow: Unknown verifier error                                      |
| 1.1i    | Error: Known verifier error                                                                                                                                                                                   | Error flow: Known verifier error                                        |
| **1.2** | **System displays screen 'Website check' (cross-device only)**<ul><li>Message: Is the website starting with: [organization url]?</li><li>Actions: Yes continue, Stop, About the website check, Help</li></ul> |                                                                         |
| 1.2a    | User selects Yes continue                                                                                                                                                                                     | 1.3                                                                     |
| 1.2b    | User selects Stop                                                                                                                                                                                             | 2                                                                       |
| 1.2c    | User selects About the website check                                                                                                                                                                          | 3                                                                       |
| 1.2d    | User selects Help                                                                                                                                                                                             | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| **1.3** | **System displays screen 'Approve login organization'**<ul><li>Do you want to share details with [Organization]?</li><li>Actions: Share, Check all details, Help, Close, Stop</li></ul>                       |                                                                         |
| 1.3a    | User selects Share                                                                                                                                                                                            | 1.4                                                                     |
| 1.3b    | User selects Check all details                                                                                                                                                                                | 4                                                                       |
| 1.3e    | User selects Help                                                                                                                                                                                             | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 1.3f    | User selects Close                                                                                                                                                                                            | 2                                                                       |
| 1.3g    | User selects Stop                                                                                                                                                                                             | 2                                                                       |
| **1.4** | **System executes partial flow [PF2.4 Confirm a protected action](../partial-flows/PF2.4_ConfirmProtectedAction.md)**<ul><li>Cancelable</li></ul>                                                                            |                                                                         |
| 1.4a    | Result: Confirm                                                                                                                                                                                               | 1.5                                                                     |
| 1.4b    | Result: Cancel                                                                                                                                                                                                | 2                                                                       |
| 1.4c    | Result: Back                                                                                                                                                                                                  | Back                                                                    |
| **1.5** | **System displays screen 'Disclosure success'**<ul><li>Message: Success!</li><li>Actions: To my overview (cross-device flow), Go to website (same-device flow), See activity, Help, Close</li></ul>           |                                                                         |
| 1.5a    | User selects To my overview (in cross-device flow only)                                                                                                                                                       | Go to: [UC7.1 Show all available cards](UC7.1_ShowAllAvailableCards.md) |
| 1.5b    | User selects Go to website <br>&rarr; System opens browser and suspends app (in same-device flow only)                                                                                                        |                                                                         |
| 1.5c    | User selects See activity                                                                                                                                                                                     | Go to: [UC6.3 Show event](UC6.3_ShowHistoryEvent.md)                    |
| 1.5d    | User selects Help                                                                                                                                                                                             | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 1.5e    | User selects Close <br>&rarr; System opens browser and suspends app                                                                                                                                           | Go to: [UC7.1 Show all available cards](UC7.1_ShowAllAvailableCards.md) |
| 1.5f    | Error: No internet                                                                                                                                                                                            | Error flow: No internet                                                 |
| 1.5g    | Error: Server unreachable                                                                                                                                                                                     | Error flow: Server unreachable                                          |
| **2**   | **STOP**                                                                                                                                                                                                      |                                                                         |
| **2.1** | **System displays screen 'Stop'**<ul><li>Message: Are you sure you want to stop?</li><li>Actions: Yes Stop, No, Report Problem</li></ul>                                                                      |                                                                         |
| 2.1a    | User selects Yes stop                                                                                                                                                                                         |                                                                         |
| 2.1b    | User selects No                                                                                                                                                                                               | Back                                                                    |
| 2.1c    | User selects Report a problem                                                                                                                                                                                 | 6                                                                       |
| **3**   | **GET WEBSITE CHECK DETAILS**                                                                                                                                                                                 |                                                                         |
| **3.1** | **System displays screen 'Under construction'**<ul><li>Actions: Back</li></ul>                                                                                                                                |                                                                         |
| 3.1a    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| **4**   | **GET SHARING DETAILS**                                                                                                                                                                                       |                                                                         |
| **4.1** | **System displays screen 'Approve Organization'**<ul><li>Message: Information about logging in at [organization]?</li><li>Actions: [organization], View data, Read the agreement, Help, Back</li></ul>        |                                                                         |
| 4.1a    | User selects [organization]                                                                                                                                                                                   | 7                                                                       |
| 4.1b    | User selects View data                                                                                                                                                                                        | 4.2                                                                     |
| 4.1c    | User selects Read the agreement                                                                                                                                                                               | 6                                                                       |
| 4.1d    | User selects Help                                                                                                                                                                                             | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 4.1e    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| **4.2** | **System displays screen 'Requested data'**<ul><li># from [Card Title]</li><li>Actions: Details Incorrect, Help, Back</li></ul>                                                                               |                                                                         |
| 4.2a    | User selects Details Incorrect                                                                                                                                                                                | 5                                                                       |
| 4.2b    | User selects Help                                                                                                                                                                                             | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 4.2c    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| **5**   | **WHEN DETAILS ARE INCORRECT**                                                                                                                                                                                |                                                                         |
| **5.1** | **System displays screen 'Details incorrect'**<ul><li>Message: Details Incorrect</li><li>Actions: Back</li></ul>                                                                                              |                                                                         |
| 5.1a    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| **6**   | **GET SHARING AGREEMENT DETAILS**                                                                                                                                                                             |                                                                         |
| **6.2** | **System displays screen 'Agreements'**<ul><li>Message: agreements</li><li>Actions: Privacy policy, Back</li></ul>                                                                                            |                                                                         |
| 6.2a    | User selects Privacy policy <br>&rarr; System opens browser and suspends app                                                                                                                                  |                                                                         |
| 6.2b    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| **7**   | **GET VERIFIER ORGANIZATION DETAILS**                                                                                                                                                                         |                                                                         |
| **7.1** | **System displays screen 'About organization'**<ul><li>Message: About [Organization]</li><li>Actions: Help, Back</li></ul>                                                                                    |                                                                         |
| 7.1a    | User selects Help                                                                                                                                                                                             | Go to: [UC9.6 Get help](UC9.6_GetHelp.md)                               |
| 7.1b    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| **8**   | **REPORT PROBLEM**                                                                                                                                                                                            |                                                                         |
| **8.1** | **System displays screen 'Report problem'**<ul><li>Message: Report Problem</li><li>Options: problems</li><li>Actions: Back</li></ul>                                                                          |                                                                         |
| 8.1a    | User selects Back                                                                                                                                                                                             | Back                                                                    |
| 8.1b    | User selects Problem option                                                                                                                                                                                   | 8.2                                                                     |
| **8.2** | **System displays screen 'Under construction'**<ul><li>Actions: Back</li></ul>                                                                                                                                |                                                                         |
| 8.2a    | User selects Back                                                                                                                                                                                             | 8.1                                                                     |